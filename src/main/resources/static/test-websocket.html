<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Notifications Test</title>

    <!-- Ù…ÙƒØªØ¨Ø§Øª SockJS + STOMP -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.6.1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>

    <style>
        body { font-family: Arial, sans-serif; margin: 30px; }
        h1 { color: #2c3e50; }
        ul { list-style: none; padding: 0; }
        li { background: #ecf0f1; margin: 5px 0; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
<h1>Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h1>
<ul id="notifications"></ul>

<script>
    // âš ï¸ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø«Ø§Ø¨ØªØŒ ÙƒÙ…Ø§ ÙƒØ§Ù† Ù‚Ø¨Ù„ Ø£ÙŠ ØªØ¹Ø¯ÙŠÙ„
    const userId = 1; // Ø¹Ø¯Ù„ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… ÙŠØ¯ÙˆÙŠ Ø¥Ø°Ø§ Ø­Ø¨ÙŠØª

    // Ø§ØªØµØ§Ù„ WebSocket
    const socket = new SockJS('https://localhost:8443/ws');
    const stompClient = Stomp.over(socket);

    stompClient.connect({}, function(frame) {
        console.log("âœ… WebSocket Connected:", frame);

        // Ù‚Ù†Ø§Ø© Ø¹Ø§Ù…Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        stompClient.subscribe('/topic/appointments/all', function(message) {
            console.log("ğŸ“¢ All Users Notification:", message.body);
            const li = document.createElement("li");
            li.textContent = message.body;
document.getElementById("notifications").appendChild(li);
        });

        // Ù‚Ù†Ø§Ø© Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        stompClient.subscribe(`/topic/appointments/${userId}`, function(message) {
            console.log("ğŸ“© User Notification:", message.body);
            const li = document.createElement("li");
            li.textContent = message.body;
            document.getElementById("notifications").appendChild(li);
            alert("Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯: " + message.body);
        });

    }, function(error) {
        console.error("âŒ WebSocket error:", error);
        alert("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ WebSocketØŒ ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆHTTPS Ø¹Ù„Ù‰ 8443");
    });
</script>

</body>
</html>